(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{392:function(e,t,o){var content=o(439);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(25).default)("51d1a1a8",content,!0,{sourceMap:!1})},437:function(e,t,o){e.exports=o.p+"img/default-profile.697fdcd.png"},438:function(e,t,o){"use strict";o(392)},439:function(e,t,o){var l=o(24)(!1);l.push([e.i,".upload-image-circle .ivu-upload-drag,.upload-image .ivu-upload-drag{height:100px!important}.background-black .ivu-upload-drag{background-color:unset;border-radius:4px}.background-black i{color:#8b8b8b}.upload-files .ivu-upload-drag,.upload-image-circle .ivu-upload-drag{border:0}.upload-image{display:inline-block;text-align:center;overflow:hidden;position:relative;margin-right:4px}.upload-image .image{width:100%;height:100px;opacity:.5}.upload-image-circle{border-radius:100%}.upload-image-circle .image,.upload-image-circle .upload-image-cover{border-radius:100%;height:100px}.upload-image-size{width:100px;height:100px}.upload-image-cover{line-height:100px;position:absolute;top:0;bottom:0;left:0;right:0}.upload-files{display:inline-block;text-align:left}.upload-image i{display:inline-block;font-size:35px;cursor:pointer;margin:0 2px}.upload-list{display:inline-block;text-align:center;border:1px solid transparent;border-radius:6px;overflow:hidden;background:#fff;position:relative;box-shadow:0 1px 1px rgba(0,0,0,.2);margin-right:4px}.upload-list,.upload-list-large{height:100px;width:100px}.upload-list-cover{position:absolute;top:0;bottom:0;left:0;right:0;background:rgba(0,0,0,.6)}.upload-list:hover .upload-list-cover{display:block}.upload-list-cover i{color:#fff;font-size:20px;cursor:pointer;margin:0 2px}.div-upload-large,.ivu-upload .ivu-upload-drag,.uploaded-image{width:100px;height:100px}.uploaded-image{-o-object-fit:cover;object-fit:cover}.loading{line-height:unset;margin-top:0;-webkit-animation:ani-demo-spin .5s linear infinite;animation:ani-demo-spin .5s linear infinite}",""]),e.exports=l},453:function(e,t,o){"use strict";o.r(t);var l=o(8),n=(o(19),o(33),o(67),o(68),o(16),o(277),o(363)),r=o.n(n),d={filters:{},props:{multiple:{type:Boolean,default:function(){return!1}},showButton:{type:Boolean,default:function(){return!1}},customProperties:{type:Object,default:function(){return{}}},fieldKey:{type:String,default:function(){return""}},isIncident:{type:Boolean,default:function(){return!1}},value:{validator:function(e){return r.a.isObject(e)||r.a.isArray(e)||e instanceof File},default:function(e){return r.a.isArray(e)?[]:{}}},selectType:{type:String,default:function(){return"select"}},showUploadList:{type:Boolean,default:function(){return!1}},size:{type:String,default:function(){return"large"}},uploadImageCircle:{type:Boolean,default:function(){return!1}}},data:function(){return{previewItem:"",uploadList:[],visible:!1,loading:!1,renderAlertMessages:!1,defaultImage:o(437)}},computed:{onShowUploadList:function(){return this.showUploadList&&!this.multiple},filterUploadList:function(){return this.showUploadList?[]:r.a.filter(this.uploadList,(function(e){return"delete"!==e.action}))}},watch:{value:function(e,t){if(this.multiple){var o=r.a.compact(e);r.a.forEach(o,(function(e,t){e.index=t})),this.uploadList=o}},renderAlertMessages:function(e){e&&this.$Message.error({top:50,duration:3,content:this.$t("messages.limit_upload")})}},mounted:function(){},methods:{handleView:function(e){this.previewItem=e,this.visible=!0},clearFiles:function(e){this.multiple||this.$emit("updateParentValue",Object(l.a)({},this.fieldKey,{}));var t=r.a.cloneDeep(this.uploadList);if(t[e]&&t[e].url){t[e]=r.a.omit(t[e],["url","content_type"]),t[e].action="delete";var o=t[e];t.splice(e,1),t=r.a.concat(t,o)}else t.splice(e,1);this.$emit("updateParentValue",Object(l.a)({},this.fieldKey,t))},handleFormatError:function(e){this.$Notice.warning({title:"The file format is incorrect",desc:"File format of "+e.name+" is incorrect, please select jpg or png."})},handleMaxSize:function(e){this.$Notice.warning({title:"Exceeding file size limit",desc:"File  "+e.name+" is too large, no more than 2M."})},validate:function(e){if(r.a.isEmpty(this.customProperties.format))return!0;var t=this.subFileType(e.type),o=r.a.includes(this.customProperties.format,t);return o||this.handleFormatError(e),o},handleUpload:function(e){var t,o=this,image=new Image;if(this.validate(e)){this.loading=!0;var n=new FileReader;n.readAsDataURL(e),n.onload=function(d){if(image.src=n.result,e.src=n.result,t=o.resizeImage(image,e),o.multiple){var c=[];c.push(t),c=r.a.concat(o.value,e),o.isIncident&&c.length>10?(o.renderAlertMessages=!0,c=r.a.filter(c,(function(e,t){return t<=9})),o.$emit("updateParentValue",Object(l.a)({},o.fieldKey,c))):o.$emit("updateParentValue",Object(l.a)({},o.fieldKey,c)),setTimeout((function(){o.renderAlertMessages=!1}),500)}else o.$emit("updateParentValue",Object(l.a)({},o.fieldKey,e))},setTimeout((function(){o.loading=!1}),500)}return!1},resizeImage:function(img,e){var t=this;return new Promise((function(o,l){img.onload=function(){var canvas=document.createElement("canvas"),image=t.checkMaxSizeImage(1024,1024,img);if(image.isResized){canvas.width=image.width,canvas.height=image.height;var l=canvas.getContext("2d");l.drawImage(img,0,0,image.width,image.height);var n=l.canvas.toDataURL(img,e.type);e.src=n,fetch(n).then((function(e){return e.blob()})).then((function(t){var l=new File([t],e.name,{type:e.type});l.src=e.src,o(l)}))}else o(e)}}))},checkMaxSizeImage:function(e,t,image){var o=!1,l=image.width,n=image.height;return l>n&&l>e&&(n*=e/l,l=e,o=!0),n>t&&(l*=t/n,n=t,o=!0),{isResized:o,width:l,height:n}},pdfPreview:function(data){if(data.url)window.open(data.url);else{var iframe="<iframe width='100%' height='100%' src='"+data.src+"'></iframe>",e=window.open();e.document.open(),e.document.write(iframe),e.document.close()}},fileType:function(e){if(e){var t=e.split("/");return t[0]}return""},subFileType:function(e){return e?e.split("/")[1]:""}}},c=(o(438),o(27)),component=Object(c.a)(d,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[e.showButton||"drag"===e.selectType?o("div",e._l(e.filterUploadList,(function(t,l){return o("div",{key:l,staticStyle:{"overflow-wrap":"break-word"}},[o("Icon",{staticClass:"mr-5",attrs:{type:"ios-attach"}}),e._v(" "),"image"===e.fileType(t.type?t.type:t.content_type)?o("a",{on:{click:function(o){return e.handleView(t)}}},[e._v("\n        "+e._s(t.name)+"\n      ")]):"pdf"===e.subFileType(t.type?t.type:t.content_type)?o("a",{on:{click:function(o){return e.pdfPreview(t)}}},[e._v("\n        "+e._s(t.name)+"\n      ")]):o("a",{attrs:{href:t.src,download:t.name}},[e._v("\n        "+e._s(t.name)+"\n      ")]),e._v(" "),o("span",{staticStyle:{float:"right"}},[o("Icon",{staticClass:"pointer",attrs:{type:"md-close"},nativeOn:{click:function(o){return e.clearFiles(t.index)}}})],1)],1)})),0):e.multiple?o("div",[e._l(e.filterUploadList,(function(t,l){return o("div",{key:l,class:"upload-list upload-list-"+e.size},["image"===e.fileType(t.type?t.type:t.content_type)?o("div",{staticStyle:{display:"inline-block"}},[o("img",{staticClass:"uploaded-image",attrs:{src:t.src||t.url}}),e._v(" "),o("div",{staticClass:"upload-list-cover"},[o("Icon",{staticStyle:{"margin-top":"40px"},attrs:{type:"ios-eye-outline"},nativeOn:{click:function(o){return e.handleView(t)}}}),e._v(" "),e.multiple?o("Icon",{staticStyle:{"margin-top":"40px"},attrs:{type:"ios-trash-outline"},nativeOn:{click:function(o){return e.clearFiles(t.index)}}}):e._e()],1)]):o("div",{staticStyle:{display:"inline-block"}},[o("Icon",{attrs:{type:"md-document",size:"30"}}),e._v(" "),o("div",{staticClass:"upload-list-cover"},[o("a",{attrs:{href:t.src,download:t.name}},[o("Icon",{attrs:{type:"ios-eye-outline"}})],1),e._v(" "),o("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(o){return e.clearFiles(t.index)}}})],1)],1)])})),e._v(" "),o("Upload",e._b({ref:"upload",class:"upload-"+e.size,attrs:{multiple:e.multiple,"before-upload":e.handleUpload,"default-file-list":e.uploadList,"on-exceeded-size":e.handleMaxSize,"on-format-error":e.handleFormatError,"show-upload-list":e.onShowUploadList,accept:"image/*,video/*",type:"drag",action:""}},"Upload",e.customProperties,!1),[o("div",{staticStyle:{position:"absolute",top:"30px",bottom:"0",left:"0",right:"0"}},[e.loading?o("Icon",{staticClass:"loading",attrs:{type:"ios-loading",size:"32"}}):o("Icon",{attrs:{type:"md-cloud-upload",size:"32"}})],1)])],2):o("Upload",e._b({ref:"upload",staticClass:"upload-image upload-image-size",class:(e.uploadImageCircle?"upload-image-circle":"")+" "+(e.value.src||e.value.url?"background-black":""),attrs:{"before-upload":e.handleUpload,"default-file-list":e.uploadList,"on-exceeded-size":e.handleMaxSize,"on-format-error":e.handleFormatError,"show-upload-list":e.onShowUploadList,accept:"image/*,video/*",type:"drag",action:""}},"Upload",e.customProperties,!1),[o("img",{staticClass:"image",attrs:{src:e.value.src||e.value.url||e.defaultImage}}),e._v(" "),o("div",{staticClass:"upload-image-cover"},[o("Icon",{attrs:{color:"#ba6b57",type:"md-cloud-upload",size:"32"}})],1)]),e._v(" "),o("Modal",{attrs:{"footer-hide":""},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?o("img",{staticStyle:{width:"100%"},attrs:{src:e.previewItem.src||e.previewItem.url}}):e._e()])],1)}),[],!1,null,null,null);t.default=component.exports}}]);