(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{362:function(t,e,n){"use strict";n.d(e,"a",(function(){return j})),n.d(e,"d",(function(){return y})),n.d(e,"b",(function(){return w})),n.d(e,"c",(function(){return O}));n(26),n(15),n(19),n(31),n(32);var r=n(8),o=n(3),c=(n(23),n(47)),d=n.n(c),l=n(366),f=n.n(l),h=n(94),A=n.n(h);function m(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function v(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var j="".concat("https://altitudeapp.altitude.co.th","/api/v1/user");function y(t,path){return f()(t,path)}function w(t,e){if(!t)return{"Content-Type":"application/json"};var n={"Content-Type":"application/json"};e&&(n={"Content-Type":"multipart/form-data"});var r=A.a.get("token");return r&&(n["auth-token"]="Bearer ".concat(r)),n}function _(t){return t.response&&401===t.response.status&&navigator.onLine&&(window.location.href="/no_permission?locale=".concat(window.$nuxt.$store.state.language)),t.response}function O(t,e,n){return x.apply(this,arguments)}function x(){return(x=Object(o.a)(regeneratorRuntime.mark((function t(e,n,r){var o,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=w(r.auth),c=v(v({},o),r.headers),t.prev=2,t.next=5,d()({method:e,url:n,headers:c,data:r.data,params:r.params});case 5:return l=t.sent,t.abrupt("return",l);case 9:return t.prev=9,t.t0=t.catch(2),t.abrupt("return",_(t.t0));case 12:return t.prev=12,t.finish(12);case 14:case"end":return t.stop()}}),t,null,[[2,9,12,14]])})))).apply(this,arguments)}},364:function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return A})),n.d(e,"c",(function(){return m})),n.d(e,"d",(function(){return v}));n(365),n(70),n(16),n(71),n(72),n(67),n(68),n(44),n(40),n(33),n(15),n(42),n(43);var r=n(363),o=n.n(r),c=n(0),d=n.n(c);function l(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,d=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return c=t.done,t},e:function(t){d=!0,o=t},f:function(){try{c||null==n.return||n.return()}finally{if(d)throw o}}}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function h(t){return t?d()(t).format("DD/MM/YYYY"):"-"}function A(t){return t?d()(t).local().format("DD/MM/YYYY HH:mm:ss"):"-"}function m(t){return t?Number(t).toFixed(0).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):Number(0)}function v(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=new FormData;return o.a.each(t,(function(c,d){var f=d;if(e&&(f="".concat(e,"[").concat(d,"]")),o.a.includes(n,d))o.a.isArray(c)?o.a.forEach(c,(function(t,e){t instanceof File?(r.append("".concat(f,"[]"),t),r.delete("".concat(f,"[][").concat(e,"][][src]")),r.delete("".concat(f,"[][").concat(e,"][][index]"))):(t.action||(t.action="edit"),o.a.forEach(t,(function(t,e){r.append("".concat(f,"[][").concat(e,"]"),t)})))})):c instanceof File?(r.append("".concat(f),c),r.delete("".concat(f,"[").concat(d,"][][src]")),r.delete("".concat(f,"[").concat(d,"][][index]"))):r.append("".concat(f,"[").concat(d,"]"),c);else if(o.a.isArray(t[d])&&!o.a.isEmpty(t[d]))o.a.each(c,(function(t,n){if(f="".concat(d,"[]"),e&&(f="".concat(e,"[").concat(d,"][]")),o.a.isObject(c[n])&&!o.a.isEmpty(c[n])){var h,A=l(v(t,f).entries());try{for(A.s();!(h=A.n()).done;){var m=h.value;r.append(m[0],m[1])}}catch(t){A.e(t)}finally{A.f()}}else r.append("".concat(f),t)}));else if(o.a.isObject(t[d])){var h,A=l(v(c,f).entries());try{for(A.s();!(h=A.n()).done;){var m=h.value;r.append(m[0],m[1])}}catch(t){A.e(t)}finally{A.f()}}else r.append(f,c)})),r}},365:function(t,e,n){"use strict";var r=n(6),o=n(34),c=n(35),d=n(276),l=n(69),f=n(11),h=n(55).f,A=n(56).f,m=n(13).f,v=n(367).trim,j="Number",y=r.Number,w=y,_=y.prototype,O=c(n(93)(_))==j,x="trim"in String.prototype,I=function(t){var e=l(t,!1);if("string"==typeof e&&e.length>2){var n,r,o,c=(e=x?e.trim():v(e,3)).charCodeAt(0);if(43===c||45===c){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===c){switch(e.charCodeAt(1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+e}for(var code,d=e.slice(2),i=0,f=d.length;i<f;i++)if((code=d.charCodeAt(i))<48||code>o)return NaN;return parseInt(d,r)}}return+e};if(!y(" 0o1")||!y("0b1")||y("+0x1")){y=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof y&&(O?f((function(){_.valueOf.call(n)})):c(n)!=j)?d(new w(I(e)),n,y):I(e)};for(var C,E=n(9)?h(w):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),N=0;E.length>N;N++)o(w,C=E[N])&&!o(y,C)&&m(y,C,A(w,C));y.prototype=_,_.constructor=y,n(17)(r,j,y)}},366:function(t,e,n){var r,o,c;c=function(){function t(t){var e=[];if(0===t.length)return"";if("string"!=typeof t[0])throw new TypeError("Url must be a string. Received "+t[0]);if(t[0].match(/^[^/:]+:\/*$/)&&t.length>1){var n=t.shift();t[0]=n+t[0]}t[0].match(/^file:\/\/\//)?t[0]=t[0].replace(/^([^/:]+):\/*/,"$1:///"):t[0]=t[0].replace(/^([^/:]+):\/*/,"$1://");for(var i=0;i<t.length;i++){var component=t[i];if("string"!=typeof component)throw new TypeError("Url must be a string. Received "+component);""!==component&&(i>0&&(component=component.replace(/^[\/]+/,"")),component=i<t.length-1?component.replace(/[\/]+$/,""):component.replace(/[\/]+$/,"/"),e.push(component))}var r=e.join("/"),o=(r=r.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return r=o.shift()+(o.length>0?"?":"")+o.join("&")}return function(){return t("object"==typeof arguments[0]?arguments[0]:[].slice.call(arguments))}},t.exports?t.exports=c():void 0===(o="function"==typeof(r=c)?r.call(e,n,e,t):r)||(t.exports=o)},367:function(t,e,n){var r=n(5),o=n(41),c=n(11),d=n(368),l="["+d+"]",f=RegExp("^"+l+l+"*"),h=RegExp(l+l+"*$"),A=function(t,e,n){var o={},l=c((function(){return!!d[t]()||"​"!="​"[t]()})),f=o[t]=l?e(m):d[t];n&&(o[n]=f),r(r.P+r.F*l,"String",o)},m=A.trim=function(t,e){return t=String(o(t)),1&e&&(t=t.replace(f,"")),2&e&&(t=t.replace(h,"")),t};t.exports=A},368:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},369:function(t,e,n){"use strict";var r=n(5),o=n(96)(5),c="find",d=!0;c in[]&&Array(1).find((function(){d=!1})),r(r.P+r.F*d,"Array",{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),n(95)(c)},370:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n(3),o=n(91),c=n(92),d=(n(45),n(23),n(363)),l=n.n(d),f=n(0),h=n.n(f),A=n(362),m=n(364),v=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(o.a)(this,t),this.json=e,this.json.answer_json_data=e.answer_json_data||[],this.json.attachments=e.attachments||[],this.json.due_datetime=h()(e.due_datetime).format()||null,this.json.description_translations=e.description_translations||{en:"",th:""}}var e,n,d,f;return Object(c.a)(t,[{key:"save",value:(f=Object(r.a)(regeneratorRuntime.mark((function t(e,n){var r,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=l.a.cloneDeep(this.json)).default_question_answer=r.answer_json_data[0].choice_text,r.answer_json_data=JSON.stringify(r.answer_json_data),r.asset_id=n,r.due_datetime=h()(r.due_datetime).unix(),o=Object(m.d)(r,"incident",["attachments"]),this.json.id){t.next=12;break}return t.next=9,Object(A.c)("post",Object(A.d)(A.a,"projects/".concat(e,"/incidents")),{headers:Object(A.b)(!0),data:o});case 9:c=t.sent,t.next=15;break;case 12:return t.next=14,Object(A.c)("patch",Object(A.d)(A.a,"projects/".concat(e,"/incidents/").concat(this.json.id)),{headers:Object(A.b)(!0),data:o});case 14:c=t.sent;case 15:return t.abrupt("return",c);case 16:case"end":return t.stop()}}),t,this)}))),function(t,e){return f.apply(this,arguments)})}],[{key:"index",value:(d=Object(r.a)(regeneratorRuntime.mark((function e(n,r,o){var c,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(A.c)("get",Object(A.d)(A.a,"projects/".concat(n,"/incidents")),{params:{page:r,per_page:o},headers:Object(A.b)(!0)});case 2:return c=e.sent,d=l.a.map(c.data.incidents,(function(e,n){return new t(e)})),e.abrupt("return",{incidents:d,total_count:c.data.total_count});case 5:case"end":return e.stop()}}),e)}))),function(t,e,n){return d.apply(this,arguments)})},{key:"show",value:(n=Object(r.a)(regeneratorRuntime.mark((function e(n,r){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",{});case 2:return e.next=4,Object(A.c)("get",Object(A.d)(A.a,"projects/".concat(n,"/incidents/").concat(r)),{headers:Object(A.b)(!0)});case 4:return o=e.sent,e.abrupt("return",new t(o.data.incident));case 6:case"end":return e.stop()}}),e)}))),function(t,e){return n.apply(this,arguments)})},{key:"complete",value:(e=Object(r.a)(regeneratorRuntime.mark((function t(e,n,r){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=Object(m.d)(r.json,"incident"),t.next=3,Object(A.c)("patch",Object(A.d)(A.a,"projects/".concat(e,"/incidents/").concat(n,"/complete")),{headers:Object(A.b)(!0),data:o});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)}))),function(t,n,r){return e.apply(this,arguments)})}]),t}()},371:function(t,e,n){t.exports=n.p+"img/phone.effef9c.png"},380:function(t,e,n){var content=n(411);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(25).default)("6f587bec",content,!0,{sourceMap:!1})},409:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAfCAYAAAD9cg1AAAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAGKADAAQAAAABAAAAHwAAAABz3YuHAAACW0lEQVRIDa2U4VHbQBCFpQz/UTpQKoipgEsFQAU4FUQlOBXEVGC5AkwFVipAVJBzBZgKnO95ThrdWTpZwM48dm/37dvT3eEkOcMOh8MMPALZK1iB7IzWcYqEgEQtKMAS7MF2vDtJLvpINOfkV66mnQpXaZpa5ajXuFVnyJ7anWqhpWFCaxoNTjtcAysgUOJbg7NwC4O/pt6rdeRA1mfrGEJTc9RoWIRNrP+BX2q8IFjitXgAeyDLwb2CCfa7w82Jteldyh+Jlnxh0RDIGWIdUQksiJmhaMIjQqNSky75EjQ7V05mwRuYg3PspYdUkTO9r4jdWIoZ+LB9+bDCiEB0AOc4A1v5EZ3BsjcAoRzoJyFzorroryC8o0HBsOANcMUfeAkLO6AXYhlYgHPMuzvvkp2QQbQCFki82X3JugZR6/CPPG+AMhBqtjkj1O9LI6684gpMspMB6kbMTlKJkPvuoKXzJXN36Pqid5n3Be5oHlG6AxJdgb9Al5zhv4Oo8fXit+YNIGuBfiL0giS4pmGOTxhQ4P4ojhm8b/TYhuMNoLCHMKe4AU+NuMjES2oVoQYPme2Ki+QNUAJCjcsVh+ZqYTq6jl6yOtn1LKowUjwZgGB7BMQl/c94M6IzWPaOyAlt8Vd0FOAerDmaipy+5AbETP+cD12CN4BCDV7AsyP9pKF0cY5fuHjI7diIHodtCN4ACnpFhmIJNh1xXf6GXAommTdAnRqCu52kEiGfXHKEO7WUHRs4El2gXsr1VIU+PjoZuAGvoDy+cwILPtu08ay9NBamb0fvzXGXlXr/A3HFzVIV1OwTAAAAAElFTkSuQmCC"},410:function(t,e,n){"use strict";n(380)},411:function(t,e,n){var r=n(24)(!1);r.push([t.i,".custom-content[data-v-3d435968]{padding:5pt}",""]),t.exports=r},447:function(t,e,n){"use strict";n.r(e);n(369);var r=n(363),o=n.n(r),c=n(364),d=n(370),l={filters:{formatDatetime:function(t){return Object(c.b)(t)},truncate:function(t){return o.a.truncate(t,{length:100,separator:/,? +/})}},data:function(){return{iconPhone:n(371),showIncidents:[],page:1,perPage:10,incidents:[],isLoading:!0,totalPage:0}},computed:{headerName:function(){return this.$nuxt.$store.getters.getLandingPageHeader}},mounted:function(){this.$nuxt.isOffline?this.$router.push({name:"lost_internet_connection",params:{currentLanguage:this.$store.state.language}}):(this.scrollHandler(),this.fetchIncidents())},methods:{fetchIncidents:function(){var t=this;d.a.index(this.$route.params.projectId,this.page,this.perPage).then((function(e){t.incidents=t.incidents.concat(e.incidents),t.totalPage=e.total_pages,t.isLoading=!1})).catch((function(){t.incidents=[],t.isLoading=!1}))},setPage:function(){this.page+=1,this.fetchIncidents()},scrollHandler:function(){var t=this;window.onscroll=function(){t.$refs.pageRow&&(document.documentElement.scrollTop+window.innerHeight>=t.$refs.pageRow.$el.scrollHeight&&t.page!==t.totalPage&&t.setPage())}},getTitle:function(t){if(t.json.incident_type.question){var e=o.a.find(t.json.answer_json_data,["question_id",t.json.incident_type.question.id]);return e?e.choice_text:"-"}return"-"},statusColor:function(t){return"opened"===t?"#CF795B":"pending_approval"===t?"#3A913C":"completed"===t?"#C1272D":"#9D9D9D"}}},f=(n(410),n(27)),component=Object(f.a)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.isLoading?r("GLoading"):r("Row",{ref:"pageRow",attrs:{type:"flex"}},[r("Col",{attrs:{md:24,xs:24}},[r("div",{staticClass:"custom-content"},[r("center",[r("Card",{staticClass:"header-content",attrs:{bordered:!1,"dis-hover":"",padding:0}},[r("Row",{staticClass:"mt-8 ml-20 mr-20",attrs:{type:"flex",justify:"space-between"}},[r("Col",[r("p",{staticClass:"header-font-size"},[t._v("\n                "+t._s(t.headerName)+"\n              ")])]),t._v(" "),r("Col",[r("img",{staticClass:"header-icon",attrs:{src:t.iconPhone}})])],1)],1),t._v(" "),r("div",{staticClass:"custom-incident-button"},[r("Button",{attrs:{size:"large",to:{name:"projects-projectId-assets-assetId-incidents-form",params:{projectId:t.$route.params.projectId,assetId:t.$route.params.assetId}}}},[r("Row",{attrs:{type:"flex"}},[r("Col",{staticClass:"ml-20 mr-10"},[r("img",{attrs:{src:n(409),width:"25",height:"30"}})]),t._v(" "),r("Col",{staticStyle:{bottom:"4px"}},[t._v("\n                "+t._s(t.$t("button.new_incident"))+"\n              ")])],1)],1)],1)],1),t._v(" "),t.incidents?r("span",t._l(t.incidents,(function(e){return r("div",{key:e.json.id,staticClass:"incident-list",staticStyle:{"margin-bottom":"5px","border-bottom":"1px solid #2b1505","border-color":"#2b1505"}},[r("nuxt-link",{attrs:{to:{name:"projects-projectId-assets-assetId-incidents-incidentId-incident",params:{projectId:t.$route.params.projectId,assetId:t.$route.params.assetId,incidentId:e.json.id},query:{jwt:t.$store.state.token,locale:t.$store.state.language}}}},[r("Row",{attrs:{type:"flex"}},[r("Col",{staticClass:"ml-20",attrs:{span:"14"}},[r("div",[t._v("\n                  "+t._s(t._f("formatDatetime")(e.json.created_at))+"\n                ")]),t._v(" "),r("div",{staticClass:"fix-show-text"},[t._v("\n                  "+t._s(e.json.incident_type.name_translations[t.$store.state.language])+"\n                ")]),t._v(" "),r("div",{staticClass:"fix-show-text",staticStyle:{color:"#fff"}},[t._v("\n                  "+t._s(t.getTitle(e))+"\n                ")])]),t._v(" "),r("Col",{staticStyle:{"place-self":"center"},attrs:{span:"8"}},[r("div",{staticClass:"fix-show-text incident-tag"},[r("Tag",{attrs:{color:t.statusColor(e.json.status)}},[r("div",{staticStyle:{"font-size":"14px"}},[t._v("\n                      "+t._s(t.$t("statuses."+e.json.status))+"\n                    ")])])],1)])],1)],1)],1)})),0):t._e(),t._v(" "),0===t.incidents.length?r("span",{staticClass:"text-center"},[r("h4",{staticStyle:{"margin-top":"50%"}},[t._v(t._s(t.$t("default.no_data")))])]):t._e()],1)])],1)}),[],!1,null,"3d435968",null);e.default=component.exports}}]);